import{V as ie,_ as se,a as ne}from"./VSnackbar-BlvgPhG8.js";import{_ as re}from"./FormUpload.vue_vue_type_style_index_0_lang-BcYdOxtk.js";import{_ as O,c as ue,V as de,a as me}from"./VDataTableServer-CydhH6eb.js";import{_ as G}from"./AppTextField.vue_vue_type_script_setup_true_lang-DyTkVLXo.js";import{d as q,r as n,ay as R,w as pe,c as z,b as e,f as i,m as l,a2 as b,F as L,e as x,v as h,$ as ce,a0 as K,t as M,o as E,ad as fe,az as ve,aA as ge,X as j,g as be,a as Ve,Z as I}from"./index-BNa8Zz1m.js";import{V as _e,$ as H}from"./api-Bdh3YCOR.js";import{V as Ce}from"./VDialog-BrQxgecu.js";import{V as Q,a as De,b as ke}from"./VCard-BSZxM56q.js";import{V as Te}from"./VCardText-BjKykbi8.js";import{V as ye,a as A}from"./VRow-DB6fPz5p.js";import{u as we}from"./useApi-DRCa-2hq.js";import{V as xe}from"./VSpacer-B-w_gHuT.js";import{V as Me}from"./VDivider-CmAQevXm.js";import"./VOverlay--wbpgCWy.js";import"./forwardRefs-B931MWyl.js";import"./VImg-C5MTH-lj.js";import"./VTextField-OXWtipX2.js";import"./VChip-B4HNdsZH.js";import"./VAvatar-8H7Ackmy.js";import"./index-C4wfZp0O.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./VList-CToLNfeo.js";import"./VMenu-DXpfONEV.js";/* empty css              */const Ue={class:"text-h4 mb-2"},Ae=q({__name:"FormCoa",props:{cardDetails:{default:()=>({Kode:"",Nama:"",Tipe:""})},isDialogVisible:{type:Boolean},isEditMode:{type:Boolean,default:!1}},emits:["submit","update:isDialogVisible","reload"],setup(B,{emit:T}){const V=B,y=T,$=n([{title:"Aset",value:"Aset"},{title:"Kewajiban",value:"Kewajiban"},{title:"Ekuitas",value:"Ekuitas"},{title:"Pendapatan",value:"Pendapatan"},{title:"Beban",value:"Beban"}]),d=n(!1),m=n(""),v=n("success"),o=n(structuredClone(R(V.cardDetails)));pe(()=>V.cardDetails,p=>{o.value=structuredClone(R(p))},{deep:!0,immediate:!0});const D=n(!1),_=p=>{y("update:isDialogVisible",p)},w=async()=>{var p,t,c,k;try{if(D.value=!0,o.value.Kode===null||o.value.Kode===""){m.value="Kode coa harus diisi",v.value="error",d.value=!0;return}if(o.value.Nama===null||o.value.Nama===""){m.value="Nama coa harus diisi",v.value="error",d.value=!0;return}if(o.value.Tipe===null||o.value.Tipe===""){m.value="Tipe coa harus diisi",v.value="error",d.value=!0;return}const C={Kode:o.value.Kode,Nama:o.value.Nama,Tipe:o.value.Tipe},r=V.isEditMode?"PUT":"POST",N=V.isEditMode?`api/MasterCoa/${o.value.Kode}`:"api/MasterCoa",u=await H(N,{method:r,body:C});((p=u==null?void 0:u.Metadata)==null?void 0:p.Code)==="200"?(m.value=((t=u==null?void 0:u.Metadata)==null?void 0:t.Message)||"Terjadi kesalahan!",v.value="success",d.value=!0,y("reload"),y("submit",o.value),y("update:isDialogVisible",!1)):(console.log((c=u==null?void 0:u.Metadata)==null?void 0:c.Message),m.value=((k=u==null?void 0:u.Metadata)==null?void 0:k.Message)||"Terjadi kesalahan!",v.value="error",d.value=!0)}catch(C){console.error("Gagal submit order:",C),m.value="Gagal submit order!",v.value="error",d.value=!0}finally{D.value=!1}};return(p,t)=>{const c=se,k=G,C=O;return E(),z(L,null,[e(Ce,{width:p.$vuetify.display.smAndDown?"auto":600,"model-value":V.isDialogVisible,"onUpdate:modelValue":_},{default:i(()=>[e(c,{onClick:t[0]||(t[0]=r=>_(!1))}),e(Q,{class:"pa-2 pa-sm-10"},{default:i(()=>[e(De,{class:"text-center"},{default:i(()=>[e(ke,null,{default:i(()=>[x("h4",Ue,h(V.isEditMode?"EDIT COA":"ADD COA"),1)]),_:1})]),_:1}),e(Te,{class:"pt-6"},{default:i(()=>[e(_e,{onSubmit:ce(w,["prevent"])},{default:i(()=>[e(ye,null,{default:i(()=>[e(A,{cols:"12"},{default:i(()=>[e(k,{modelValue:l(o).Kode,"onUpdate:modelValue":t[1]||(t[1]=r=>l(o).Kode=r),label:"Kode",placeholder:"110000",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:i(()=>[e(k,{modelValue:l(o).Nama,"onUpdate:modelValue":t[2]||(t[2]=r=>l(o).Nama=r),label:"Nama",placeholder:"Aset Lancar",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:i(()=>[e(C,{modelValue:l(o).Tipe,"onUpdate:modelValue":t[3]||(t[3]=r=>l(o).Tipe=r),label:"Tipe Coa",placeholder:"Pilih salah satu",items:l($),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(A,{cols:"12",class:"text-center"},{default:i(()=>[e(K,{class:"me-4",type:"submit",loading:l(D)},{default:i(()=>t[6]||(t[6]=[M(" Submit ")])),_:1,__:[6]},8,["loading"]),e(K,{color:"secondary",variant:"tonal",onClick:t[4]||(t[4]=r=>_(!1))},{default:i(()=>t[7]||(t[7]=[M(" Cancel ")])),_:1,__:[7]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(ie,{modelValue:l(d),"onUpdate:modelValue":t[5]||(t[5]=r=>b(d)?d.value=r:null),transition:"scale-transition",location:"top end",variant:"flat",color:l(v),timeout:1e3},{default:i(()=>[M(h(l(m)),1)]),_:1},8,["modelValue","color"])],64)}}}),Ke={class:"d-flex flex-wrap gap-4 ma-6"},$e={class:"d-flex align-center"},Ne={class:"d-flex gap-4 flex-wrap align-center"},ta=q({__name:"index",async setup(B){var S;let T,V;const y=fe("userData");console.log((S=y.value)==null?void 0:S.unit);const $=[{title:"Kode",key:"Kode",sortable:!1,width:"15%"},{title:"Nama",key:"Nama",sortable:!1,width:"65%"},{title:"Tipe",key:"Tipe",sortable:!1,width:"15%"}],d=n(!1),m=n(!1),v=n(!1),o=n(""),D=n([]),_=n(!1),w=n(null),p=n({Kode:"",Nama:"",Tipe:""}),t=n(10),c=n(1),k=ve({filter:o,page:c,pageSize:t}),{data:C,execute:r}=([T,V]=ge(()=>we(ue("/api/MasterCoa/GetListCoa",{query:k}))),T=await T,V(),T),N=j(()=>{var f;return((f=C.value)==null?void 0:f.Data)??[]}),u=j(()=>{var f;return((f=C.value)==null?void 0:f.TotalCount)??0}),X=()=>{d.value=!0},Y=()=>{p.value={Kode:"",Nama:"",Tipe:""},v.value=!1,m.value=!0},Z=f=>{p.value={...f},v.value=!0,m.value=!0},J=f=>{w.value=f,_.value=!0},W=async f=>{var a,U;if(!(!f||!w.value))try{const g=await H(`/api/MasterCoa/${w.value.Kode}`,{method:"DELETE"});((a=g==null?void 0:g.Metadata)==null?void 0:a.Code)==="200"?await r():console.error("Gagal menghapus data:",(U=g==null?void 0:g.Metadata)==null?void 0:U.Message)}catch(g){console.error("Terjadi kesalahan koneksi ke server:",g)}finally{w.value=null}};return(f,a)=>{var F;const U=G,g=O,P=Ve("IconBtn"),ee=me,ae=Ae,le=re,te=ne;return E(),z(L,null,[x("div",null,[e(Q,{title:"Master COA",class:"mb-6"},{default:i(()=>[x("div",Ke,[x("div",$e,[e(U,{modelValue:l(o),"onUpdate:modelValue":a[0]||(a[0]=s=>b(o)?o.value=s:null),placeholder:"Cari Data",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),e(xe),x("div",Ne,[e(g,{modelValue:l(t),"onUpdate:modelValue":a[1]||(a[1]=s=>b(t)?t.value=s:null),items:[5,10,20,25,50]},null,8,["modelValue"]),e(K,{color:"primary","prepend-icon":"tabler-file-upload",onClick:a[2]||(a[2]=()=>X())},{default:i(()=>a[11]||(a[11]=[M(" Upload ")])),_:1,__:[11]}),e(K,{color:"primary","prepend-icon":"tabler-plus",onClick:a[3]||(a[3]=()=>Y())},{default:i(()=>a[12]||(a[12]=[M(" Tambah ")])),_:1,__:[12]})])]),e(Me,{class:"mt-4"}),e(de,{"items-per-page":l(t),"onUpdate:itemsPerPage":a[5]||(a[5]=s=>b(t)?t.value=s:null),"model-value":l(D),"onUpdate:modelValue":a[6]||(a[6]=s=>b(D)?D.value=s:null),page:l(c),"onUpdate:page":a[7]||(a[7]=s=>b(c)?c.value=s:null),headers:$,items:l(N),"items-length":l(u),class:"text-no-wrap"},{"item.actions":i(({item:s})=>[e(P,null,{default:i(()=>[e(I,{icon:"tabler-edit",onClick:oe=>Z(s)},null,8,["onClick"])]),_:2},1024),e(P,null,{default:i(()=>[e(I,{icon:"tabler-trash",color:"error",onClick:oe=>J(s)},null,8,["onClick"])]),_:2},1024)]),bottom:i(()=>[e(ee,{page:l(c),"onUpdate:page":a[4]||(a[4]=s=>b(c)?c.value=s:null),"items-per-page":l(t),"total-items":l(u)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})]),(E(),be(ae,{key:((F=l(p))==null?void 0:F.Kode)??"new","is-dialog-visible":l(m),"onUpdate:isDialogVisible":a[8]||(a[8]=s=>b(m)?m.value=s:null),"card-details":l(p),"is-edit-mode":l(v),onReload:l(r)},null,8,["is-dialog-visible","card-details","is-edit-mode","onReload"])),e(le,{"is-dialog-visible":l(d),"onUpdate:isDialogVisible":a[9]||(a[9]=s=>b(d)?d.value=s:null),title:"Upload Excel COA","api-url":"/api/MasterCoa/ImportExcel",onReload:l(r)},null,8,["is-dialog-visible","onReload"]),e(te,{"is-dialog-visible":l(_),"onUpdate:isDialogVisible":a[10]||(a[10]=s=>b(_)?_.value=s:null),"confirmation-question":"Apakah Anda yakin ingin menghapus data ini?","confirm-title":"Data Terhapus!","confirm-msg":"Data telah berhasil dihapus.","cancel-title":"Dibatalkan","cancel-msg":"Penghapusan dibatalkan.","confirm-text":"Ya, Hapus","cancel-text":"Batal","confirm-color":"error",onConfirm:W},null,8,["is-dialog-visible"])],64)}}});export{ta as default};
