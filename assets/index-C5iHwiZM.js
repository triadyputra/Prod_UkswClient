import{V as te,_ as oe,a as h,b as ie,c as se,d as ne,e as re}from"./VDataTableServer-CFrbHknF.js";import{_ as ue}from"./FormUpload.vue_vue_type_style_index_0_lang-ChpmFncV.js";import{V as de,_ as j,$ as G}from"./api-iWGrpksS.js";import{d as q,r as d,ay as B,w as me,c as z,b as e,f as i,m as a,a2 as _,F as O,e as x,v as P,$ as pe,a0 as E,t as M,o as I,az as ce,aA as fe,X as F,g as ve,a as ge,Z as R}from"./index-CPXDzLqB.js";import{V as Ve}from"./VDialog-CUKmP0wA.js";import{V as L,a as be,b as _e}from"./VCard-BMiIVcmW.js";import{V as Ue}from"./VCardText-Cm-dWlT7.js";import{V as De,a as A}from"./VRow-BSPA_dgX.js";import{u as Ce}from"./useApi-Chpjk6H2.js";import{V as ke}from"./VSpacer-DKwLegsr.js";import{V as ye}from"./VDivider-C826nIp0.js";import"./VOverlay-v5ZFBQta.js";import"./forwardRefs-B931MWyl.js";import"./VImg-GZHM-FZn.js";import"./VTextField-C-q2j1-I.js";import"./index-C4wfZp0O.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./VList-UOYQYGg0.js";import"./VAvatar-Dj4P1b64.js";import"./VMenu-CBHAxbL8.js";import"./VChip-C2ky5FTS.js";/* empty css              */const we={class:"text-h4 mb-2"},Ne=q({__name:"FormUnit",props:{cardDetails:{default:()=>({Id:"",Kode:"",Nama:"",Alamat:"",Jenis:"",Npwp:""})},isDialogVisible:{type:Boolean},isEditMode:{type:Boolean,default:!1}},emits:["submit","update:isDialogVisible","reload"],setup(K,{emit:C}){const v=K,k=C,y=d([{title:"Entitas",value:"Entitas"},{title:"Unit",value:"Unit"}]),u=d(!1),c=d(""),p=d("success"),l=d(structuredClone(B(v.cardDetails)));me(()=>v.cardDetails,n=>{l.value=structuredClone(B(n))},{deep:!0,immediate:!0});const U=d(!1),D=n=>{k("update:isDialogVisible",n)},w=async()=>{var n,t,N,g;try{if(U.value=!0,l.value.Kode===null||l.value.Kode===""){c.value="Kode Unit harus diisi",p.value="error",u.value=!0;return}if(l.value.Nama===null||l.value.Nama===""){c.value="Nama Unit harus diisi",p.value="error",u.value=!0;return}if(l.value.Alamat===null||l.value.Alamat===""){c.value="Alamat unit harus diisi",p.value="error",u.value=!0;return}if(l.value.Jenis===null||l.value.Jenis===""){c.value="Jenis unit harus diisi",p.value="error",u.value=!0;return}const V={Kode:l.value.Kode,Nama:l.value.Nama,Alamat:l.value.Alamat,Jenis:l.value.Jenis,Npwp:l.value.Npwp};v.isEditMode&&(V.Id=l.value.Id);const r=v.isEditMode?"PUT":"POST",T=v.isEditMode?`api/MasterUnit/${l.value.Id}`:"api/MasterUnit",m=await G(T,{method:r,body:V});((n=m==null?void 0:m.Metadata)==null?void 0:n.Code)==="200"?(c.value=((t=m==null?void 0:m.Metadata)==null?void 0:t.Message)||"Terjadi kesalahan!",p.value="success",u.value=!0,k("reload"),k("submit",l.value),k("update:isDialogVisible",!1)):(console.log((N=m==null?void 0:m.Metadata)==null?void 0:N.Message),c.value=((g=m==null?void 0:m.Metadata)==null?void 0:g.Message)||"Terjadi kesalahan!",p.value="error",u.value=!0)}catch(V){console.error("Gagal submit order:",V),c.value="Gagal submit order!",p.value="error",u.value=!0}finally{U.value=!1}};return(n,t)=>{const N=oe,g=j,V=h;return I(),z(O,null,[e(Ve,{width:n.$vuetify.display.smAndDown?"auto":600,"model-value":v.isDialogVisible,"onUpdate:modelValue":D},{default:i(()=>[e(N,{onClick:t[0]||(t[0]=r=>D(!1))}),e(L,{class:"pa-2 pa-sm-10"},{default:i(()=>[e(be,{class:"text-center"},{default:i(()=>[e(_e,null,{default:i(()=>[x("h4",we,P(v.isEditMode?"EDIT UNIT":"ADD UNIT"),1)]),_:1})]),_:1}),e(Ue,{class:"pt-6"},{default:i(()=>[e(de,{onSubmit:pe(w,["prevent"])},{default:i(()=>[e(De,null,{default:i(()=>[e(A,{cols:"12"},{default:i(()=>[e(g,{modelValue:a(l).Kode,"onUpdate:modelValue":t[1]||(t[1]=r=>a(l).Kode=r),label:"Kode",placeholder:"01",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:i(()=>[e(g,{modelValue:a(l).Nama,"onUpdate:modelValue":t[2]||(t[2]=r=>a(l).Nama=r),label:"Nama",placeholder:"UKSW",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:i(()=>[e(g,{modelValue:a(l).Alamat,"onUpdate:modelValue":t[3]||(t[3]=r=>a(l).Alamat=r),label:"Alamat",placeholder:"Salatiga",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:i(()=>[e(g,{modelValue:a(l).Npwp,"onUpdate:modelValue":t[4]||(t[4]=r=>a(l).Npwp=r),label:"Npwp",placeholder:"0122154545",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(A,{cols:"12"},{default:i(()=>[e(V,{modelValue:a(l).Jenis,"onUpdate:modelValue":t[5]||(t[5]=r=>a(l).Jenis=r),label:"Jenis Coa",placeholder:"Pilih salah satu",items:a(y),clearable:"","clear-icon":"tabler-x"},null,8,["modelValue","items"])]),_:1}),e(A,{cols:"12",class:"text-center"},{default:i(()=>[e(E,{class:"me-4",type:"submit",loading:a(U)},{default:i(()=>t[8]||(t[8]=[M(" Submit ")])),_:1,__:[8]},8,["loading"]),e(E,{color:"secondary",variant:"tonal",onClick:t[6]||(t[6]=r=>D(!1))},{default:i(()=>t[9]||(t[9]=[M(" Cancel ")])),_:1,__:[9]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(te,{modelValue:a(u),"onUpdate:modelValue":t[7]||(t[7]=r=>_(u)?u.value=r:null),transition:"scale-transition",location:"top end",variant:"flat",color:a(p),timeout:1e3},{default:i(()=>[M(P(a(c)),1)]),_:1},8,["modelValue","color"])],64)}}}),Ae={class:"d-flex flex-wrap gap-4 ma-6"},xe={class:"d-flex align-center"},Me={class:"d-flex gap-4 flex-wrap align-center"},Ye=q({__name:"index",async setup(K){let C,v;const k=[{title:"Kode",key:"Kode",sortable:!1},{title:"Nama",key:"Nama",sortable:!1},{title:"Jenis",key:"Jenis",sortable:!1},{title:"Alamat",key:"Alamat",sortable:!1},{title:"Npwp",key:"Npwp",sortable:!1},{title:"Actions",key:"actions",sortable:!1,width:"5%"}],y=d(!1),u=d(!1),c=d(!1),p=d(""),l=d([]),U=d(!1),D=d(null),w=d({Id:"",Kode:"",Nama:"",Alamat:"",Jenis:"",Npwp:""}),n=d(10),t=d(1),N=ce({filter:p,page:t,pageSize:n}),{data:g,execute:V}=([C,v]=fe(()=>Ce(se("/api/MasterUnit/GetListUnit",{query:N}))),C=await C,v(),C),r=F(()=>{var f;return((f=g.value)==null?void 0:f.Data)??[]}),T=F(()=>{var f;return((f=g.value)==null?void 0:f.TotalCount)??0}),m=()=>{y.value=!0},H=()=>{w.value={Id:"",Kode:"",Nama:"",Alamat:"",Jenis:"",Npwp:""},c.value=!1,u.value=!0},Q=f=>{w.value={...f},c.value=!0,u.value=!0},W=f=>{D.value=f,U.value=!0},X=async f=>{var o,$;if(!(!f||!D.value))try{const b=await G(`/api/MasterUnit/${D.value.Id}`,{method:"DELETE"});((o=b==null?void 0:b.Metadata)==null?void 0:o.Code)==="200"?await V():console.error("Gagal menghapus data:",($=b==null?void 0:b.Metadata)==null?void 0:$.Message)}catch(b){console.error("Terjadi kesalahan koneksi ke server:",b)}finally{D.value=null}};return(f,o)=>{var J;const $=j,b=h,S=ge("IconBtn"),Y=re,Z=Ne,ee=ue,ae=ie;return I(),z(O,null,[x("div",null,[e(L,{title:"Master COA",class:"mb-6"},{default:i(()=>[x("div",Ae,[x("div",xe,[e($,{modelValue:a(p),"onUpdate:modelValue":o[0]||(o[0]=s=>_(p)?p.value=s:null),placeholder:"Cari Data",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),e(ke),x("div",Me,[e(b,{modelValue:a(n),"onUpdate:modelValue":o[1]||(o[1]=s=>_(n)?n.value=s:null),items:[5,10,20,25,50]},null,8,["modelValue"]),e(E,{color:"primary","prepend-icon":"tabler-file-upload",onClick:o[2]||(o[2]=()=>m())},{default:i(()=>o[11]||(o[11]=[M(" Upload ")])),_:1,__:[11]}),e(E,{color:"primary","prepend-icon":"tabler-plus",onClick:o[3]||(o[3]=()=>H())},{default:i(()=>o[12]||(o[12]=[M(" Tambah ")])),_:1,__:[12]})])]),e(ye,{class:"mt-4"}),e(ne,{"items-per-page":a(n),"onUpdate:itemsPerPage":o[5]||(o[5]=s=>_(n)?n.value=s:null),"model-value":a(l),"onUpdate:modelValue":o[6]||(o[6]=s=>_(l)?l.value=s:null),page:a(t),"onUpdate:page":o[7]||(o[7]=s=>_(t)?t.value=s:null),headers:k,items:a(r),"items-length":a(T),class:"text-no-wrap"},{"item.actions":i(({item:s})=>[e(S,null,{default:i(()=>[e(R,{icon:"tabler-edit",onClick:le=>Q(s)},null,8,["onClick"])]),_:2},1024),e(S,null,{default:i(()=>[e(R,{icon:"tabler-trash",color:"error",onClick:le=>W(s)},null,8,["onClick"])]),_:2},1024)]),bottom:i(()=>[e(Y,{page:a(t),"onUpdate:page":o[4]||(o[4]=s=>_(t)?t.value=s:null),"items-per-page":a(n),"total-items":a(T)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})]),(I(),ve(Z,{key:((J=a(w))==null?void 0:J.Kode)??"new","is-dialog-visible":a(u),"onUpdate:isDialogVisible":o[8]||(o[8]=s=>_(u)?u.value=s:null),"card-details":a(w),"is-edit-mode":a(c),onReload:a(V)},null,8,["is-dialog-visible","card-details","is-edit-mode","onReload"])),e(ee,{"is-dialog-visible":a(y),"onUpdate:isDialogVisible":o[9]||(o[9]=s=>_(y)?y.value=s:null),title:"Upload Excel Unit","api-url":"/api/MasterUnit/ImportExcel",onReload:a(V)},null,8,["is-dialog-visible","onReload"]),e(ae,{"is-dialog-visible":a(U),"onUpdate:isDialogVisible":o[10]||(o[10]=s=>_(U)?U.value=s:null),"confirmation-question":"Apakah Anda yakin ingin menghapus data ini?","confirm-title":"Data Terhapus!","confirm-msg":"Data telah berhasil dihapus.","cancel-title":"Dibatalkan","cancel-msg":"Penghapusan dibatalkan.","confirm-text":"Ya, Hapus","cancel-text":"Batal","confirm-color":"error",onConfirm:X},null,8,["is-dialog-visible"])],64)}}});export{Ye as default};
