import{f as B}from"./dateUtils-CBqjUJMf.js";import{V as ae,_ as te,a as le}from"./VSnackbar-iehoD4iR.js";import{_ as oe}from"./AppAutocomplete.vue_vue_type_script_setup_true_lang-2NBGO_Ox.js";import{_ as G}from"./AppTextField.vue_vue_type_script_setup_true_lang-D4kmOkS7.js";import{d as L,r,ay as F,w as ie,c as q,b as e,f as o,m as a,a2 as _,F as z,e as M,v as $,$ as se,a0 as I,t as A,o as N,az as ne,aA as re,X as O,g as de,a as ue,Z as R}from"./index-CfGr7fxM.js";import{V as me,$ as j}from"./api-C8ws2ADT.js";import{u as Y}from"./useApi-C0mHdd6N.js";import{V as pe}from"./VDialog-BhRlawkS.js";import{V as H,a as ce,b as fe}from"./VCard-CoFJ3VGH.js";import{V as ve}from"./VCardText-DO2Slsmo.js";import{V as be,a as x}from"./VRow-BcSiJiKb.js";import{c as ge,_ as Ve,V as De,a as _e}from"./VDataTableServer-CvaayqLI.js";import{V as Ce}from"./VSpacer-Cp4UMCvi.js";import{V as ye}from"./VDivider-C2MDwIC0.js";import"./VOverlay-_lY9Rmx9.js";import"./forwardRefs-B931MWyl.js";import"./VImg-DjeIU0LB.js";import"./VTextField-md1QIUMW.js";import"./VList-C7PTRKj5.js";import"./VAvatar-CYHDSwcG.js";import"./VMenu-DelKjUG5.js";import"./VChip-DD7TiWK_.js";import"./index-C4wfZp0O.js";import"./_commonjsHelpers-D6-XlEtG.js";/* empty css              */const ke={class:"text-h4 mb-2"},Ee=L({__name:"FormEleminasi",props:{cardDetails:{default:()=>({Id:"",Periode:"",Kode:"",Nama:"",Debet:0,Kredit:0})},isDialogVisible:{type:Boolean},isEditMode:{type:Boolean,default:!1},optUnit:{},unit:{}},emits:["submit","update:isDialogVisible","reload"],setup(T,{emit:K}){const g=T,P=K,u=r(!1),f=r(""),p=r("success"),i=r(structuredClone(F(g.cardDetails))),C=r([]),y=r(!1);ie(()=>g.cardDetails,m=>{i.value=structuredClone(F(m))},{deep:!0,immediate:!0});const k=m=>{P("update:isDialogVisible",m)},v=async()=>{var m,t,E;try{if(y.value=!0,!i.value.Periode){f.value="Periode harus diisi",p.value="error",u.value=!0;return}if(!i.value.Kode){f.value="Kode COA harus diisi",p.value="error",u.value=!0;return}const D={Id:i.value.Id,Periode:i.value.Periode,Kode:i.value.Kode,Debet:i.value.Debet,Kredit:i.value.Kredit},w=g.isEditMode?"PUT":"POST",d=g.isEditMode?`api/Eleminasi/${i.value.Id}`:"api/Eleminasi",c=await j(d,{method:w,body:D});((m=c==null?void 0:c.Metadata)==null?void 0:m.Code)==="200"?(f.value=((t=c==null?void 0:c.Metadata)==null?void 0:t.Message)||"Berhasil disimpan!",p.value="success",u.value=!0,P("reload"),P("submit",i.value),P("update:isDialogVisible",!1)):(f.value=((E=c==null?void 0:c.Metadata)==null?void 0:E.Message)||"Terjadi kesalahan!",p.value="error",u.value=!0)}catch(D){console.error("Gagal submit order:",D),f.value="Gagal submit order!",p.value="error",u.value=!0}finally{y.value=!1}};async function V(){console.log("Panggil");try{const t=await Y("/api/combo/ComboCoaYayasan");console.log("Respon Data COA:",t),C.value=t.data.value}catch(m){console.error("âŒ Error Fetch COA:",m),C.value=[]}}return V(),(m,t)=>{const E=te,D=G,w=oe;return N(),q(z,null,[e(pe,{width:m.$vuetify.display.smAndDown?"auto":600,"model-value":g.isDialogVisible,"onUpdate:modelValue":k},{default:o(()=>[e(E,{onClick:t[0]||(t[0]=d=>k(!1))}),e(H,{class:"pa-2 pa-sm-10"},{default:o(()=>[e(ce,{class:"text-center"},{default:o(()=>[e(fe,null,{default:o(()=>[M("h4",ke,$(g.isEditMode?"EDIT ELEMINASI":"ADD ELEMINASI"),1)]),_:1})]),_:1}),e(ve,{class:"pt-6"},{default:o(()=>[e(me,{onSubmit:se(v,["prevent"])},{default:o(()=>[e(be,null,{default:o(()=>[e(x,{cols:"12"},{default:o(()=>[e(D,{modelValue:a(i).Periode,"onUpdate:modelValue":t[1]||(t[1]=d=>a(i).Periode=d),label:"Periode",placeholder:"112025",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(x,{cols:"12"},{default:o(()=>[e(w,{modelValue:a(i).Kode,"onUpdate:modelValue":t[2]||(t[2]=d=>a(i).Kode=d),label:"Kode Coa",items:a(C),"item-title":"title","item-value":"value",placeholder:"Pilih Salah satu",clearable:"","clear-icon":"tabler-x",autocomplete:"off"},null,8,["modelValue","items"])]),_:1}),e(x,{cols:"12"},{default:o(()=>[e(D,{modelValue:a(i).Debet,"onUpdate:modelValue":t[3]||(t[3]=d=>a(i).Debet=d),label:"Debet",type:"number",placeholder:"112025",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(x,{cols:"12"},{default:o(()=>[e(D,{modelValue:a(i).Kredit,"onUpdate:modelValue":t[4]||(t[4]=d=>a(i).Kredit=d),label:"Kredit",type:"number",placeholder:"112025",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",class:"text-center"},{default:o(()=>[e(I,{class:"me-4",type:"submit",loading:a(y)},{default:o(()=>t[7]||(t[7]=[A(" Submit ")])),_:1,__:[7]},8,["loading"]),e(I,{color:"secondary",variant:"tonal",onClick:t[5]||(t[5]=d=>k(!1))},{default:o(()=>t[8]||(t[8]=[A(" Cancel ")])),_:1,__:[8]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(ae,{modelValue:a(u),"onUpdate:modelValue":t[6]||(t[6]=d=>_(u)?u.value=d:null),transition:"scale-transition",location:"top end",variant:"flat",color:a(p),timeout:1e3},{default:o(()=>[A($(a(f)),1)]),_:1},8,["modelValue","color"])],64)}}}),Ke={class:"d-flex flex-wrap gap-4 ma-6"},Pe={class:"d-flex align-center"},we={class:"d-flex gap-4 flex-wrap align-center"},We=L({__name:"index",async setup(T){let K,g;const P=[{title:"Periode",key:"Periode",sortable:!1},{title:"Kode COA",key:"Kode",sortable:!1},{title:"Nama COA",key:"Nama",sortable:!1},{title:"Debet",key:"Debet",sortable:!1,align:"end"},{title:"Kredit",key:"Kredit",sortable:!1,align:"end"},{title:"Actions",key:"actions",sortable:!1,width:"5%"}];r(!1);const u=r(!1),f=r(!1),p=r(""),i=r([]),C=r(!1),y=r(null),k=r({Id:"",Periode:"",Kode:"",Nama:"",Debet:0,Kredit:0}),v=r(10),V=r(1),m=ne({filter:p,page:V,pageSize:v}),{data:t,execute:E}=([K,g]=re(()=>Y(ge("/api/Eleminasi/GetListEleminasi",{query:m}))),K=await K,g(),K),D=O(()=>{var n;return((n=t.value)==null?void 0:n.Data)??[]}),w=O(()=>{var n;return((n=t.value)==null?void 0:n.TotalCount)??0}),d=()=>{k.value={Id:"",Periode:"",Kode:"",Nama:"",Debet:0,Kredit:0},f.value=!1,u.value=!0},c=n=>{k.value={...n},f.value=!0,u.value=!0},Q=n=>{y.value=n,C.value=!0},X=async n=>{var l,U;if(!(!n||!y.value))try{const b=await j(`/api/Eleminasi/${y.value.Id}`,{method:"DELETE"});((l=b==null?void 0:b.Metadata)==null?void 0:l.Code)==="200"?await E():console.error("Gagal menghapus data:",(U=b==null?void 0:b.Metadata)==null?void 0:U.Message)}catch(b){console.error("Terjadi kesalahan koneksi ke server:",b)}finally{y.value=null}};return(n,l)=>{var h;const U=G,b=Ve,S=ue("IconBtn"),Z=_e,J=Ee,W=le;return N(),q(z,null,[M("div",null,[e(H,{title:"Eleminasi",class:"mb-6"},{default:o(()=>[M("div",Ke,[M("div",Pe,[e(U,{modelValue:a(p),"onUpdate:modelValue":l[0]||(l[0]=s=>_(p)?p.value=s:null),placeholder:"Cari Data",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),e(Ce),M("div",we,[e(b,{modelValue:a(v),"onUpdate:modelValue":l[1]||(l[1]=s=>_(v)?v.value=s:null),items:[5,10,20,25,50]},null,8,["modelValue"]),e(I,{color:"primary","prepend-icon":"tabler-plus",onClick:l[2]||(l[2]=()=>d())},{default:o(()=>l[9]||(l[9]=[A(" Tambah ")])),_:1,__:[9]})])]),e(ye,{class:"mt-4"}),e(De,{"items-per-page":a(v),"onUpdate:itemsPerPage":l[4]||(l[4]=s=>_(v)?v.value=s:null),"model-value":a(i),"onUpdate:modelValue":l[5]||(l[5]=s=>_(i)?i.value=s:null),page:a(V),"onUpdate:page":l[6]||(l[6]=s=>_(V)?V.value=s:null),headers:P,items:a(D),"items-length":a(w),class:"text-no-wrap"},{"item.Debet":o(({item:s})=>[A($(("formatNumber"in n?n.formatNumber:a(B))(s.Debet)),1)]),"item.Kredit":o(({item:s})=>[A($(("formatNumber"in n?n.formatNumber:a(B))(s.Kredit)),1)]),"item.actions":o(({item:s})=>[e(S,null,{default:o(()=>[e(R,{icon:"tabler-edit",onClick:ee=>c(s)},null,8,["onClick"])]),_:2},1024),e(S,null,{default:o(()=>[e(R,{icon:"tabler-trash",color:"error",onClick:ee=>Q(s)},null,8,["onClick"])]),_:2},1024)]),bottom:o(()=>[e(Z,{page:a(V),"onUpdate:page":l[3]||(l[3]=s=>_(V)?V.value=s:null),"items-per-page":a(v),"total-items":a(w)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})]),(N(),de(J,{key:((h=a(k))==null?void 0:h.Id)??"new","is-dialog-visible":a(u),"onUpdate:isDialogVisible":l[7]||(l[7]=s=>_(u)?u.value=s:null),"card-details":a(k),"is-edit-mode":a(f),onReload:a(E)},null,8,["is-dialog-visible","card-details","is-edit-mode","onReload"])),e(W,{"is-dialog-visible":a(C),"onUpdate:isDialogVisible":l[8]||(l[8]=s=>_(C)?C.value=s:null),"confirmation-question":"Apakah Anda yakin ingin menghapus data ini?","confirm-title":"Data Terhapus!","confirm-msg":"Data telah berhasil dihapus.","cancel-title":"Dibatalkan","cancel-msg":"Penghapusan dibatalkan.","confirm-text":"Ya, Hapus","cancel-text":"Batal","confirm-color":"error",onConfirm:X},null,8,["is-dialog-visible"])],64)}}});export{We as default};
