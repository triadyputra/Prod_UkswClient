import{f as h}from"./dateUtils-CBqjUJMf.js";import{c as R,_ as B,V as P,a as S}from"./VDataTableServer-CydhH6eb.js";import{_ as $}from"./AppTextField.vue_vue_type_script_setup_true_lang-DyTkVLXo.js";import{u as U}from"./useApi-DRCa-2hq.js";import{V as O}from"./VCard-BSZxM56q.js";import{V as z}from"./VSpacer-B-w_gHuT.js";import{d as E,r as f,az as G,aA as K,X as A,c as j,b as s,f as g,o as q,e as _,a2 as i,m as o,a0 as F,t as C,v as Y}from"./index-BNa8Zz1m.js";import{V as Q}from"./VDivider-CmAQevXm.js";import"./VTextField-OXWtipX2.js";import"./VImg-C5MTH-lj.js";import"./forwardRefs-B931MWyl.js";import"./index-C4wfZp0O.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./VList-CToLNfeo.js";import"./VAvatar-8H7Ackmy.js";import"./VOverlay--wbpgCWy.js";import"./VMenu-DXpfONEV.js";import"./VChip-B4HNdsZH.js";import"./VCardText-BjKykbi8.js";/* empty css              */const X={class:"d-flex flex-wrap gap-4 ma-6"},H={class:"d-flex align-center"},I={class:"d-flex gap-4 flex-wrap align-center"},_e=E({__name:"index",async setup(J){let d,y;const k=[{title:"Kode",key:"KodeYayasan",sortable:!1,width:"15%"},{title:"Nama",key:"NamaYayasan",sortable:!1,width:"65%"},{title:"Total",key:"Total",sortable:!1,width:"15%",align:"end"}],r=f(""),b=f([]),l=f(10),n=f(1),D=G({filter:r,page:n,pageSize:l}),{data:V,execute:M}=([d,y]=K(()=>U(R("/api/Laporan/GetLaporanGabungan",{query:D}))),d=await d,y(),d),L=A(()=>{var t;return((t=V.value)==null?void 0:t.Data)??[]}),x=A(()=>{var t;return((t=V.value)==null?void 0:t.TotalCount)??10});async function T(){var t;try{const e=`/api/Laporan/export-gabungan?periode=${r.value}`,p=await U(e),u=(t=p==null?void 0:p.data)==null?void 0:t.value.fileBase64;console.log("Respon Data COA:",u);const m=atob(u),a=new Uint8Array(m.length);for(let c=0;c<m.length;c++)a[c]=m.charCodeAt(c);const N=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w=URL.createObjectURL(N),v=document.createElement("a");v.href=w,v.download=`Laporan_Gabungan_${r.value}.xlsx`,v.click(),URL.revokeObjectURL(w)}catch(e){console.error("âŒ Error Fetch COA:",e)}}return(t,e)=>{const p=$,u=B,m=S;return q(),j("div",null,[s(O,{title:"Laporan Konsolidasi",class:"mb-6"},{default:g(()=>[_("div",X,[_("div",H,[s(p,{modelValue:o(r),"onUpdate:modelValue":e[0]||(e[0]=a=>i(r)?r.value=a:null),placeholder:"Cari Data",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),s(z),_("div",I,[s(u,{modelValue:o(l),"onUpdate:modelValue":e[1]||(e[1]=a=>i(l)?l.value=a:null),items:[5,10,20,25,50]},null,8,["modelValue"]),s(F,{color:"primary","prepend-icon":"tabler-file-upload",onClick:e[2]||(e[2]=()=>T())},{default:g(()=>e[7]||(e[7]=[C(" Download ")])),_:1,__:[7]})])]),s(Q,{class:"mt-4"}),s(P,{"items-per-page":o(l),"onUpdate:itemsPerPage":e[4]||(e[4]=a=>i(l)?l.value=a:null),"model-value":o(b),"onUpdate:modelValue":e[5]||(e[5]=a=>i(b)?b.value=a:null),page:o(n),"onUpdate:page":e[6]||(e[6]=a=>i(n)?n.value=a:null),headers:k,items:o(L),"items-length":o(x),class:"text-no-wrap"},{"item.Total":g(({item:a})=>[C(Y(("formatNumber"in t?t.formatNumber:o(h))(a.Total)),1)]),bottom:g(()=>[s(m,{page:o(n),"onUpdate:page":e[3]||(e[3]=a=>i(n)?n.value=a:null),"items-per-page":o(l),"total-items":o(x)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})])}}});export{_e as default};
