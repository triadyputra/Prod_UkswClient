import{f as N}from"./dateUtils-CBqjUJMf.js";import{c as K,_ as R,V as S,a as B}from"./VDataTableServer-CydhH6eb.js";import{_ as P}from"./AppTextField.vue_vue_type_script_setup_true_lang-DyTkVLXo.js";import{u as k}from"./useApi-DRCa-2hq.js";import{V as $}from"./VCard-BSZxM56q.js";import{V as O}from"./VSpacer-B-w_gHuT.js";import{d as z,r as f,az as E,aA as j,X as U,c as q,b as s,f as g,o as F,e as y,a2 as i,m as o,a0 as Y,t as D,v as G}from"./index-BNa8Zz1m.js";import{V as Q}from"./VDivider-CmAQevXm.js";import"./VTextField-OXWtipX2.js";import"./VImg-C5MTH-lj.js";import"./forwardRefs-B931MWyl.js";import"./index-C4wfZp0O.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./VList-CToLNfeo.js";import"./VAvatar-8H7Ackmy.js";import"./VOverlay--wbpgCWy.js";import"./VMenu-DXpfONEV.js";import"./VChip-B4HNdsZH.js";import"./VCardText-BjKykbi8.js";/* empty css              */const X={class:"d-flex flex-wrap gap-4 ma-6"},H={class:"d-flex align-center"},I={class:"d-flex gap-4 flex-wrap align-center"},ye=z({__name:"index",async setup(J){let d,_;const h=[{title:"Kode",key:"KodeYayasan",sortable:!1,width:"15%"},{title:"Nama",key:"NamaYayasan",sortable:!1,width:"65%"},{title:"Total",key:"Total",sortable:!1,width:"15%",align:"end"},{title:"Debet",key:"Debet",sortable:!1,width:"15%",align:"end"},{title:"Kredit",key:"Kredit",sortable:!1,width:"15%",align:"end"},{title:"Saldo",key:"Saldo",sortable:!1,width:"15%",align:"end"}],r=f(""),b=f([]),l=f(10),n=f(1),A=E({filter:r,page:n,pageSize:l}),{data:w,execute:M}=([d,_]=j(()=>k(K("/api/Laporan/GetLaporanKonsolidasi",{query:A}))),d=await d,_(),d),C=U(()=>{var t;return((t=w.value)==null?void 0:t.Data)??[]}),V=U(()=>{var t;return((t=w.value)==null?void 0:t.TotalCount)??10});async function L(){var t;try{const e=`/api/Laporan/export-konsolidasi?periode=${r.value}`,p=await k(e),u=(t=p==null?void 0:p.data)==null?void 0:t.value.fileBase64;console.log("Respon Data COA:",u);const m=atob(u),a=new Uint8Array(m.length);for(let c=0;c<m.length;c++)a[c]=m.charCodeAt(c);const T=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),x=URL.createObjectURL(T),v=document.createElement("a");v.href=x,v.download=`Laporan_Konsolidasi_${r.value}.xlsx`,v.click(),URL.revokeObjectURL(x)}catch(e){console.error("âŒ Error Fetch COA:",e)}}return(t,e)=>{const p=P,u=R,m=B;return F(),q("div",null,[s($,{title:"Laporan Konsolidasi",class:"mb-6"},{default:g(()=>[y("div",X,[y("div",H,[s(p,{modelValue:o(r),"onUpdate:modelValue":e[0]||(e[0]=a=>i(r)?r.value=a:null),placeholder:"Cari Data",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),s(O),y("div",I,[s(u,{modelValue:o(l),"onUpdate:modelValue":e[1]||(e[1]=a=>i(l)?l.value=a:null),items:[5,10,20,25,50]},null,8,["modelValue"]),s(Y,{color:"primary","prepend-icon":"tabler-file-upload",onClick:e[2]||(e[2]=()=>L())},{default:g(()=>e[7]||(e[7]=[D(" Download ")])),_:1,__:[7]})])]),s(Q,{class:"mt-4"}),s(S,{"items-per-page":o(l),"onUpdate:itemsPerPage":e[4]||(e[4]=a=>i(l)?l.value=a:null),"model-value":o(b),"onUpdate:modelValue":e[5]||(e[5]=a=>i(b)?b.value=a:null),page:o(n),"onUpdate:page":e[6]||(e[6]=a=>i(n)?n.value=a:null),headers:h,items:o(C),"items-length":o(V),class:"text-no-wrap"},{"item.Total":g(({item:a})=>[D(G(("formatNumber"in t?t.formatNumber:o(N))(a.Total)),1)]),bottom:g(()=>[s(m,{page:o(n),"onUpdate:page":e[3]||(e[3]=a=>i(n)?n.value=a:null),"items-per-page":o(l),"total-items":o(V)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})])}}});export{ye as default};
