import{a as be}from"./formatters-DULOiX1-.js";import{f as ee,m as _e,V as ke,_ as ye,b as Ce,c as he,a as we,d as xe,e as Ae}from"./VDataTableServer-VDRasRhn.js";import{$ as W,V as Ie,_ as pe}from"./api-CFqYjHKn.js";import{a5 as De,a6 as Pe,a7 as ae,aC as Me,r as f,aD as Se,Y as te,a8 as Ne,a9 as Re,aE as Te,b as e,q as le,F as z,aF as Ue,aG as $e,Z as H,aH as Ge,aI as Ee,d as ve,ay as oe,w as se,c as U,f as s,m as l,a2 as S,e as v,v as $,a0 as q,$ as Be,t as F,g as K,l as ne,i as Y,o as x,az as Fe,aA as ze,X as ie,a as Ke}from"./index-Bk01GPF6.js";import{a as Q}from"./profile-men-CoeanpfQ.js";import{V as Le}from"./VDialog-l5urwQ-J.js";import{V as X,a as Oe,b as je}from"./VCard-B67OKyuw.js";import{V as re}from"./VCardText-COOODWw-.js";import{V as ge}from"./VAvatar-NMeyVpuN.js";import{V as ue,a as B}from"./VRow-CRgzaJ64.js";import{V as de,a as ce,b as me}from"./VList-AkIudXen.js";import{u as Je,V as fe,m as qe}from"./VTextField-Da7XNvPe.js";import{u as He}from"./useApi-CUH5TMB_.js";import{V as Ye}from"./VSpacer-Dv1PNfGM.js";import{V as Qe}from"./VDivider-BX1ytI_T.js";import{V as We}from"./VImg-BebPicZ-.js";import"./VOverlay-D8bXdJVy.js";import"./forwardRefs-B931MWyl.js";import"./index-C4wfZp0O.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./VMenu-B9WiSIlX.js";import"./VChip-DSDdsHLF.js";/* empty css              */const Xe=Pe({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...qe(),..._e()},"VSwitch"),Ze=De()({name:"VSwitch",inheritAttrs:!1,props:Xe(),emits:{"update:focused":u=>!0,"update:modelValue":u=>!0,"update:indeterminate":u=>!0},setup(u,N){let{attrs:A,slots:V}=N;const k=ae(u,"indeterminate"),y=ae(u,"modelValue"),{loaderClasses:C}=Me(u),{isFocused:h,focus:d,blur:P}=Je(u),w=f(),c=Se&&window.matchMedia("(forced-colors: active)").matches,b=te(()=>typeof u.loading=="string"&&u.loading!==""?u.loading:u.color),I=Ne(),G=te(()=>u.id||`switch-${I}`);function E(){k.value&&(k.value=!1)}function L(M){var D,R;M.stopPropagation(),M.preventDefault(),(R=(D=w.value)==null?void 0:D.input)==null||R.click()}return Re(()=>{const[M,D]=Te(A),R=fe.filterProps(u),O=ee.filterProps(u);return e(fe,le({class:["v-switch",{"v-switch--flat":u.flat},{"v-switch--inset":u.inset},{"v-switch--indeterminate":k.value},C.value,u.class]},M,R,{modelValue:y.value,"onUpdate:modelValue":T=>y.value=T,id:G.value,focused:h.value,style:u.style}),{...V,default:T=>{let{id:g,messagesId:a,isDisabled:t,isReadonly:r,isValid:p}=T;const n={model:y,isValid:p};return e(ee,le({ref:w},O,{modelValue:y.value,"onUpdate:modelValue":[i=>y.value=i,E],id:g.value,"aria-describedby":a.value,type:"checkbox","aria-checked":k.value?"mixed":void 0,disabled:t.value,readonly:r.value,onFocus:d,onBlur:P},D),{...V,default:i=>{let{backgroundColorClasses:m,backgroundColorStyles:_}=i;return e("div",{class:["v-switch__track",c?void 0:m.value],style:_.value,onClick:L},[V["track-true"]&&e("div",{key:"prepend",class:"v-switch__track-true"},[V["track-true"](n)]),V["track-false"]&&e("div",{key:"append",class:"v-switch__track-false"},[V["track-false"](n)])])},input:i=>{let{inputNode:m,icon:_,backgroundColorClasses:o,backgroundColorStyles:j}=i;return e(z,null,[m,e("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":_||u.loading},u.inset||c?void 0:o.value],style:u.inset?void 0:j.value},[V.thumb?e(Ue,{defaults:{VIcon:{icon:_,size:"x-small"}}},{default:()=>[V.thumb({...n,icon:_})]}):e($e,null,{default:()=>[u.loading?e(Ge,{name:"v-switch",active:!0,color:p.value===!1?void 0:b.value},{default:J=>V.loader?V.loader(J):e(Ee,{active:J.isActive,color:J.color,indeterminate:!0,size:"16",width:"2"},null)}):_&&e(H,{key:String(_),icon:_,size:"x-small"},null)]})])])}})}})}),{}}}),ea={class:"text-h4 mb-2"},aa={class:"d-flex flex-column justify-center gap-4"},ta={class:"d-flex flex-wrap gap-4"},la={style:{"max-block-size":"300px","overflow-y":"auto"}},oa=ve({__name:"FormGoup",props:{cardDetails:{default:()=>({Id:"",Name:"",Access:"",Keterangan:"",Photo:Q})},isDialogVisible:{type:Boolean},isEditMode:{type:Boolean,default:!1}},emits:["submit","update:isDialogVisible","reload"],setup(u,{emit:N}){const A=u,V=N,k=f([]),y=f(null),C=f(null),h=f({}),d=f(structuredClone(oe(A.cardDetails))),P=f(),w=f(!1),c=f(!1),b=f(""),I=f("success"),G=async()=>{try{const a=await W("/api/Role/accesRole",{method:"GET"});k.value=a}catch(a){console.error("Error fetch accesRole:",a)}};se(()=>A.cardDetails,a=>{d.value=structuredClone(oe(a))},{deep:!0,immediate:!0}),se(()=>{var a;return(a=A.cardDetails)==null?void 0:a.Access},a=>{if(a)try{const t=JSON.parse(a),r={};t.forEach(p=>{r[p.IdController]||(r[p.IdController]={}),r[p.IdController][p.IdAction]=!0}),h.value=r,console.log("Loaded Access:",h.value)}catch(t){console.error("Gagal parse access JSON:",t)}},{immediate:!0});const E=a=>{var m;const r=(m=a.target.files)==null?void 0:m[0];if(!r)return;const p=["image/jpeg","image/png","image/gif"],n=100*1024;if(!p.includes(r.type)){b.value="Format file tidak valid (hanya JPG, PNG, GIF)",I.value="error",c.value=!0;return}if(r.size>n){b.value="Ukuran file maksimal 100KB",I.value="error",c.value=!0;return}const i=new FileReader;i.onload=()=>{typeof i.result=="string"&&(d.value.Photo=i.result)},i.readAsDataURL(r)},L=()=>{d.value.Photo=Q},M=()=>d.value.Name.trim()?null:"Nama Group harus diisi",D=a=>{V("update:isDialogVisible",a)},R=async()=>{var a,t,r;try{w.value=!0;const p=Object.entries(h.value).flatMap(([j,J])=>Object.entries(J).filter(([Z,Ve])=>Ve).map(([Z])=>({IdController:j,IdAction:Z}))),n=M();if(n){b.value=n,I.value="error",c.value=!0;return}const i={Id:d.value.Id,Name:d.value.Name,Access:JSON.stringify(p),Keterangan:d.value.Keterangan,Photo:d.value.Photo},m=A.isEditMode?"PUT":"POST",_=A.isEditMode?`api/Role/${d.value.Id}`:"api/Role",o=await W(_,{method:m,body:i});((a=o==null?void 0:o.Metadata)==null?void 0:a.Code)==="200"?(b.value=((t=o==null?void 0:o.Metadata)==null?void 0:t.Message)||"Berhasil disimpan!",I.value="success",c.value=!0,V("reload"),V("submit",d.value),V("update:isDialogVisible",!1)):(b.value=((r=o==null?void 0:o.Metadata)==null?void 0:r.Message)||"Terjadi kesalahan!",I.value="error",c.value=!0)}catch(p){console.error("Gagal submit data:",p),b.value="Gagal submit data!",I.value="error",c.value=!0}finally{w.value=!1}},O=a=>{y.value=a,C.value=null},T=a=>{C.value=a},g=(a,t)=>{h.value[a]||(h.value[a]={}),h.value[a][t]=!h.value[a][t]};return G(),(a,t)=>{const r=ye,p=pe;return x(),U(z,null,[e(Le,{width:a.$vuetify.display.smAndDown?"auto":900,"model-value":A.isDialogVisible,"onUpdate:modelValue":D},{default:s(()=>[e(r,{onClick:t[0]||(t[0]=n=>D(!1))}),e(X,{class:"pa-2 pa-sm-10"},{default:s(()=>[e(Oe,{class:"text-center"},{default:s(()=>[e(je,null,{default:s(()=>[v("h4",ea,$(A.isEditMode?"EDIT GROUP AKSES":"ADD GROUP AKSES"),1)]),_:1})]),_:1}),e(re,{class:"d-flex"},{default:s(()=>[e(ge,{rounded:"",size:"100",class:"me-6",image:l(d).Photo||l(Q)},null,8,["image"]),v("form",aa,[v("div",ta,[e(q,{color:"primary",size:"small",onClick:t[1]||(t[1]=n=>{var i;return(i=l(P))==null?void 0:i.click()})},{default:s(()=>[e(H,{icon:"tabler-cloud-upload",class:"d-sm-none"}),t[6]||(t[6]=v("span",{class:"d-none d-sm-block"},"Upload new photo",-1))]),_:1,__:[6]}),v("input",{ref_key:"refInputEl",ref:P,type:"file",name:"file",accept:".jpeg,.png,.jpg,.gif",hidden:"",onInput:E},null,544),e(q,{type:"reset",size:"small",color:"secondary",variant:"tonal",onClick:L},{default:s(()=>[t[7]||(t[7]=v("span",{class:"d-none d-sm-block"},"Reset",-1)),e(H,{icon:"tabler-refresh",class:"d-sm-none"})]),_:1,__:[7]})]),t[8]||(t[8]=v("p",{class:"text-body-1 mb-0"}," Allowed JPG, GIF, or PNG. Max size of 100K ",-1))])]),_:1}),e(re,{class:"pt-6"},{default:s(()=>[e(Ie,{onSubmit:Be(R,["prevent"])},{default:s(()=>[e(ue,null,{default:s(()=>[e(B,{cols:"12"},{default:s(()=>[e(p,{modelValue:l(d).Name,"onUpdate:modelValue":t[2]||(t[2]=n=>l(d).Name=n),label:"Nama Group",placeholder:"Superadmin",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(B,{cols:"12"},{default:s(()=>[e(p,{modelValue:l(d).Keterangan,"onUpdate:modelValue":t[3]||(t[3]=n=>l(d).Keterangan=n),label:"Keterangan Group Akses",placeholder:"Full Akses",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(B,{cols:"12",class:"text-center"},{default:s(()=>[e(q,{class:"me-4",type:"submit",loading:l(w),disabled:l(w)},{default:s(()=>t[9]||(t[9]=[F(" Submit ")])),_:1,__:[9]},8,["loading","disabled"]),e(q,{color:"secondary",variant:"tonal",onClick:t[4]||(t[4]=n=>D(!1))},{default:s(()=>t[10]||(t[10]=[F(" Cancel ")])),_:1,__:[10]})]),_:1})]),_:1}),e(ue,null,{default:s(()=>[e(B,{cols:"12",md:"3"},{default:s(()=>[t[11]||(t[11]=v("div",{class:"text-subtitle-2 mb-2"}," Menu ",-1)),e(de,{density:"compact",nav:""},{default:s(()=>[(x(!0),U(z,null,Y(l(k),n=>(x(),K(ce,{key:n.IdMenu,active:l(y)===n.IdMenu,class:"cursor-pointer",onClick:i=>O(n.IdMenu)},{default:s(()=>[e(me,null,{default:s(()=>[F($(n.NamaMenu),1)]),_:2},1024)]),_:2},1032,["active","onClick"]))),128))]),_:1})]),_:1,__:[11]}),l(y)?(x(),K(B,{key:0,cols:"12",md:"4"},{default:s(()=>[t[12]||(t[12]=v("div",{class:"text-subtitle-2 mb-2"}," Sub Menu ",-1)),e(de,{density:"compact",nav:""},{default:s(()=>{var n;return[v("div",la,[(x(!0),U(z,null,Y(((n=l(k).find(i=>i.IdMenu===l(y)))==null?void 0:n.ControllerViewModel)||[],i=>(x(),K(ce,{key:i.IdController,active:l(C)===i.IdController,class:"cursor-pointer",onClick:m=>T(i.IdController)},{default:s(()=>[e(me,null,{default:s(()=>[F($(i.Controller),1)]),_:2},1024)]),_:2},1032,["active","onClick"]))),128))])]}),_:1})]),_:1,__:[12]})):ne("",!0),l(C)?(x(),K(B,{key:1,cols:"12",md:"5"},{default:s(()=>[t[13]||(t[13]=v("div",{class:"text-subtitle-2 mb-2"}," Hak Akses ",-1)),e(X,{variant:"tonal",class:"pa-3"},{default:s(()=>{var n,i;return[(x(!0),U(z,null,Y(((i=(n=l(k).find(m=>m.IdMenu===l(y)))==null?void 0:n.ControllerViewModel.find(m=>m.IdController===l(C)))==null?void 0:i.ActionViewModel)||[],m=>{var _;return x(),U("div",{key:m.IdAction,class:"d-flex align-center justify-space-between mb-2"},[v("span",null,$(m.NamaAction),1),e(Ze,{density:"compact","hide-details":"",inset:"",color:"primary","model-value":((_=l(h)[l(C)])==null?void 0:_[m.IdAction])||!1,"onUpdate:modelValue":()=>g(l(C),m.IdAction)},null,8,["model-value","onUpdate:modelValue"])])}),128))]}),_:1})]),_:1,__:[13]})):ne("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["width","model-value"]),e(ke,{modelValue:l(c),"onUpdate:modelValue":t[5]||(t[5]=n=>S(c)?c.value=n:null),transition:"scale-transition",location:"top end",variant:"flat",color:l(I),timeout:2500},{default:s(()=>[F($(l(b)),1)]),_:1},8,["modelValue","color"])],64)}}}),sa={class:"d-flex flex-wrap gap-4 ma-6"},na={class:"d-flex align-center"},ia={class:"d-flex gap-4 flex-wrap align-center"},ra={class:"d-flex align-center gap-x-4"},ua={key:1},da={class:"d-flex flex-column"},ca={class:"text-base"},Ua=ve({__name:"index",async setup(u){let N,A;const V=[{title:"Nama",key:"Name",sortable:!1,width:"25%"},{title:"Keterangan",key:"Keterangan",sortable:!1,width:"70%"},{title:"Actions",key:"actions",sortable:!1,width:"5%"}],k=f(!1),y=f(!1),C=f(""),h=f([]),d=f(!1),P=f(null),w=f({Id:"",Name:"",Access:"",Keterangan:"",Photo:"",AccessDefault:null}),c=f(10),b=f(1),I=Fe({filter:C,page:b,pageSize:c}),{data:G,execute:E}=([N,A]=ze(()=>He(he("/api/Role/GetListRole",{query:I}))),N=await N,A(),N),L=ie(()=>{var g;return((g=G.value)==null?void 0:g.Data)??[]}),M=ie(()=>{var g;return((g=G.value)==null?void 0:g.TotalCount)??0}),D=()=>{w.value={Id:"",Name:"",Access:"",Keterangan:"",Photo:""},y.value=!1,k.value=!0},R=g=>{w.value={...g},y.value=!0,k.value=!0,console.log(w.value)},O=g=>{P.value=g,d.value=!0},T=async g=>{var a,t;if(!(!g||!P.value))try{const r=await W(`/api/Role/${P.value.Id}`,{method:"DELETE"});((a=r==null?void 0:r.Metadata)==null?void 0:a.Code)==="200"?await E():console.error("Gagal menghapus data:",(t=r==null?void 0:r.Metadata)==null?void 0:t.Message)}catch(r){console.error("Terjadi kesalahan koneksi ke server:",r)}finally{P.value=null}};return(g,a)=>{var _;const t=pe,r=we,p=Ke("IconBtn"),n=Ae,i=oa,m=Ce;return x(),U(z,null,[v("div",null,[e(X,{title:"Group Akses",class:"mb-6"},{default:s(()=>[v("div",sa,[v("div",na,[e(t,{modelValue:l(C),"onUpdate:modelValue":a[0]||(a[0]=o=>S(C)?C.value=o:null),placeholder:"Cari Data",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),e(Ye),v("div",ia,[e(r,{modelValue:l(c),"onUpdate:modelValue":a[1]||(a[1]=o=>S(c)?c.value=o:null),items:[5,10,20,25,50]},null,8,["modelValue"]),e(q,{color:"primary","prepend-icon":"tabler-plus",onClick:a[2]||(a[2]=()=>D())},{default:s(()=>a[9]||(a[9]=[F(" Tambah ")])),_:1,__:[9]})])]),e(Qe,{class:"mt-4"}),e(xe,{"items-per-page":l(c),"onUpdate:itemsPerPage":a[4]||(a[4]=o=>S(c)?c.value=o:null),"model-value":l(h),"onUpdate:modelValue":a[5]||(a[5]=o=>S(h)?h.value=o:null),page:l(b),"onUpdate:page":a[6]||(a[6]=o=>S(b)?b.value=o:null),headers:V,items:l(L),"items-length":l(M),class:"text-no-wrap"},{"item.Name":s(({item:o})=>[v("div",ra,[e(ge,{size:"34",variant:o.Photo?void 0:"tonal",color:o.Photo?void 0:"success"},{default:s(()=>[o.Photo?(x(),K(We,{key:0,src:o.Photo},null,8,["src"])):(x(),U("span",ua,$(("avatarText"in g?g.avatarText:l(be))(o.Name)),1))]),_:2},1032,["variant","color"]),v("div",da,[v("h6",ca,$(o.Name),1)])])]),"item.actions":s(({item:o})=>[e(p,null,{default:s(()=>[e(H,{icon:"tabler-edit",onClick:j=>R(o)},null,8,["onClick"])]),_:2},1024),e(p,null,{default:s(()=>[e(H,{icon:"tabler-trash",color:"error",onClick:j=>O(o)},null,8,["onClick"])]),_:2},1024)]),bottom:s(()=>[e(n,{page:l(b),"onUpdate:page":a[3]||(a[3]=o=>S(b)?b.value=o:null),"items-per-page":l(c),"total-items":l(M)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})]),(x(),K(i,{key:((_=l(w))==null?void 0:_.Id)??"new","is-dialog-visible":l(k),"onUpdate:isDialogVisible":a[7]||(a[7]=o=>S(k)?k.value=o:null),"card-details":l(w),"is-edit-mode":l(y),onReload:l(E)},null,8,["is-dialog-visible","card-details","is-edit-mode","onReload"])),e(m,{"is-dialog-visible":l(d),"onUpdate:isDialogVisible":a[8]||(a[8]=o=>S(d)?d.value=o:null),"confirmation-question":"Apakah Anda yakin ingin menghapus data ini?","confirm-title":"Data Terhapus!","confirm-msg":"Data telah berhasil dihapus.","cancel-title":"Dibatalkan","cancel-msg":"Penghapusan dibatalkan.","confirm-text":"Ya, Hapus","cancel-text":"Batal","confirm-color":"error",onConfirm:T},null,8,["is-dialog-visible"])],64)}}});export{Ua as default};
