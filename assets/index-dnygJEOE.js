import{f as h}from"./dateUtils-CBqjUJMf.js";import{c as R,_ as B,V as P,a as O}from"./VDataTableServer-DRYe4eAc.js";import{_ as S}from"./AppTextField.vue_vue_type_script_setup_true_lang-BBIE5MX2.js";import{u as U}from"./useApi-CfJQJctc.js";import{V as $}from"./VCard-CnEdkGt-.js";import{V as K}from"./VSpacer-CMlTyo5Y.js";import{d as z,r as f,az as E,aA as j,X as A,c as q,b as s,f as g,o as F,e as _,a2 as i,m as o,a0 as Y,t as C,v as G}from"./index-CkyamFin.js";import{V as M}from"./VDivider-CCMOLbIR.js";import"./VTextField-CvTpxxuK.js";import"./VImg-BxMoDU4W.js";import"./forwardRefs-B931MWyl.js";import"./index-C4wfZp0O.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./VList-_EbEGleu.js";import"./VAvatar-H2rtl8MM.js";import"./VOverlay-FZFN3wza.js";import"./VMenu-hJVXZJKK.js";import"./VChip-BDW7D4Ls.js";import"./VCardText-BxfCLuQl.js";/* empty css              */const Q={class:"d-flex flex-wrap gap-4 ma-6"},X={class:"d-flex align-center"},H={class:"d-flex gap-4 flex-wrap align-center"},_e=z({__name:"index",async setup(I){let d,y;const k=[{title:"Kode",key:"KodeYayasan",sortable:!1,width:"15%"},{title:"Nama",key:"NamaYayasan",sortable:!1,width:"65%"},{title:"Total",key:"Total",sortable:!1,width:"15%",align:"end"}],n=f(""),v=f([]),l=f(10),r=f(1),T=E({filter:n,page:r,pageSize:l}),{data:V,execute:J}=([d,y]=j(()=>U(R("/api/Laporan/GetLaporanKonsolidasi",{query:T}))),d=await d,y(),d),D=A(()=>{var t;return((t=V.value)==null?void 0:t.Data)??[]}),x=A(()=>{var t;return((t=V.value)==null?void 0:t.TotalCount)??10});async function L(){var t;try{const e=`/api/Laporan/export-konsolidasi?periode=${n.value}`,p=await U(e),u=(t=p==null?void 0:p.data)==null?void 0:t.value.fileBase64;console.log("Respon Data COA:",u);const m=atob(u),a=new Uint8Array(m.length);for(let c=0;c<m.length;c++)a[c]=m.charCodeAt(c);const N=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),w=URL.createObjectURL(N),b=document.createElement("a");b.href=w,b.download=`Laporan_Konsolidasi_${n.value}.xlsx`,b.click(),URL.revokeObjectURL(w)}catch(e){console.error("âŒ Error Fetch COA:",e)}}return(t,e)=>{const p=S,u=B,m=O;return F(),q("div",null,[s($,{title:"Master COA",class:"mb-6"},{default:g(()=>[_("div",Q,[_("div",X,[s(p,{modelValue:o(n),"onUpdate:modelValue":e[0]||(e[0]=a=>i(n)?n.value=a:null),placeholder:"Cari Data",style:{"inline-size":"200px"},class:"me-3"},null,8,["modelValue"])]),s(K),_("div",H,[s(u,{modelValue:o(l),"onUpdate:modelValue":e[1]||(e[1]=a=>i(l)?l.value=a:null),items:[5,10,20,25,50]},null,8,["modelValue"]),s(Y,{color:"primary","prepend-icon":"tabler-file-upload",onClick:e[2]||(e[2]=()=>L())},{default:g(()=>e[7]||(e[7]=[C(" Upload ")])),_:1,__:[7]})])]),s(M,{class:"mt-4"}),s(P,{"items-per-page":o(l),"onUpdate:itemsPerPage":e[4]||(e[4]=a=>i(l)?l.value=a:null),"model-value":o(v),"onUpdate:modelValue":e[5]||(e[5]=a=>i(v)?v.value=a:null),page:o(r),"onUpdate:page":e[6]||(e[6]=a=>i(r)?r.value=a:null),headers:k,items:o(D),"items-length":o(x),class:"text-no-wrap"},{"item.Total":g(({item:a})=>[C(G(("formatNumber"in t?t.formatNumber:o(h))(a.Total)),1)]),bottom:g(()=>[s(m,{page:o(r),"onUpdate:page":e[3]||(e[3]=a=>i(r)?r.value=a:null),"items-per-page":o(l),"total-items":o(x)},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","model-value","page","items","items-length"])]),_:1})])}}});export{_e as default};
